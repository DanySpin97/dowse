#!/usr/bin/env zsh

waitpid() {
    fn waitpid
    _pid="$1"
    req=(_pid)
    ckreq || return $?

    local lastnewline=0
    while true; do
        # here check if pid its running
        ps -p $_pid > /dev/null
        if [[ $? = 0 ]]; then
            print -n . ; lastnewline=1
            sleep 1
        else
            break
        fi
        # todo: timeout with kill -9
    done

    # this because we care to look good on the console
    [[ $lastnewline = 1 ]] && print

}
