; Supervisor config file for dowse.
;
; For more information on the config file, please see:
; http://supervisord.org/configuration.html
;
; Notes:
;  - Shell expansion ("~" or "$HOME") is not supported.  Environment
;    variables can be expanded using this syntax: "%(ENV_HOME)s".
;  - Quotes around values are not supported, except in the case of
;    the environment= options as shown below.
;  - Comments must have a leading space: "a=b ;comment" not "a=b;comment".
;  - Command will be truncated if it looks like a config file comment, e.g.
;    "command=bash -c 'foo ; bar'" will truncate to "command=bash -c 'foo ".

[unix_http_server]
file=/var/run/dowse/supervisord.sock
chown=dowse:dowse

[supervisord]
logfile=/var/log/dowse/supervisord.log
logfile_maxbytes=50MB        ; max main logfile bytes b4 rotation; default 50MB
logfile_backups=10           ; # of main logfile backups; 0 means none, default 10
loglevel=warn                ; log level; default info; others: debug,warn,trace
pidfile=/var/run/dowse/supervisord.pid
nodaemon=false               ; start in foreground if true; default false
minfds=1024                  ; min. avail startup file descriptors; default 1024
minprocs=200                 ; min. avail process descriptors;default 200
; supervisord has to run as root
;user=dowse            ; setuid to this UNIX account at startup; recommended if root

; The rpcinterface:supervisor section must remain in the config file for
; RPC (supervisorctl/web interface) to work.  Additional interfaces may be
; added by defining them in separate [rpcinterface:x] sections.

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///var/run/dowse/supervisord.sock
prompt=dowse

;[program:setup_dirs]
;command=/opt/dowse/scripts/setup_dirs.sh
;priority=10
;startsecs=0
;autorestart=unexpected
;redirect_stderr=true
;stdout_logfile=/var/log/dowse/supervisor/setup_dirs.log

[program:setup_sysctl]
command=/opt/dowse/scripts/setup_sysctl.sh
priority=10
startsecs=0
autorestart=unexpected
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/setup_sysctl.log

[program:setup_iptables]
command=/opt/dowse/scripts/setup_iptables.sh
priority=10
startsecs=0
autorestart=unexpected
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/setup_iptables.log

[program:dhcpd]
command=/opt/dowse/daemons/dhcpd
priority=100
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/dhcpd.log

[program:dnsmasq]
command=/opt/dowse/daemons/dnsmasq
priority=100
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/dnsmasq.log

[program:mosquitto]
command=/opt/dowse/daemons/mosquitto
priority=100
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/mosquitto.log

[program:dowse-to-mosquitto]
command=/opt/dowse/daemons/dowse-to-mosquitto
; dowse-to-mosquitto needs to start after mosquitto
priority=110
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/dowse-to-mosquitto.log

[program:netdata]
command=/opt/dowse/daemons/netdata
priority=100
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/netdata.log

[program:node-red]
command=/opt/dowse/daemons/node-red
priority=100
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/node-red.log

[program:pg2ipset]
command=/opt/dowse/daemons/pg2ipset
priority=110
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/pg2ipset.log

[program:redis]
command=/opt/dowse/daemons/redis
priority=100
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/redis.log

[program:redis-volatile]
command=/opt/dowse/daemons/redis-volatile
priority=110
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/redis-volatile.log

[program:stubby]
command=/opt/dowse/daemons/stubby
priority=100
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/stubby.log

[program:webui2]
command=/opt/dowse/daemons/webui2
priority=120
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/dowse/supervisor/webui2.log

